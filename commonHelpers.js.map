{"version":3,"file":"commonHelpers.js","sources":["../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst key = '37184762-fd326293791c817732540ec51';\n\nconst elements = {\n  form: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.js-gallery'),\n  loadBtn: document.querySelector('.load-more'),\n};\n\nlet search;\n\nelements.form.addEventListener('submit', evt => {\n  evt.preventDefault();\n  const form = evt.currentTarget;\n  search = form.elements.searchQuery.value;\n  searchImages(search);\n  form.reset();\n});\n\nelements.loadBtn.addEventListener('click', () => {\n  searchMoreImages(search);\n});\n\nconst gallery = new SimpleLightbox('.gallery > .photo-card > a');\n\nlet page;\nlet maxPages;\n\nasync function searchImages(text) {\n  elements.loadBtn.hidden = true;\n  elements.gallery.innerHTML = '';\n  page = 1;\n\n  text = text.trim();\n  if (!text) {\n    showMessage('error', 'Please, enter text to search and try again.');\n    return;\n  }\n  try {\n    const response = await fetchImages(text);\n    maxPages = Math.ceil(response.data.totalHits / 40);\n    const data = response.data.hits;\n    if (!data.length) {\n      showMessage(\n        'error',\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    } else {\n      showMessage(\n        'info',\n        `Hooray! We found ${response.data.totalHits} images.`\n      );\n      elements.gallery.innerHTML = createPhotoMarkup(data);\n      gallery.refresh();\n\n      if (page < maxPages) {\n        elements.loadBtn.hidden = false;\n      } else {\n        showMessage(\n          'info',\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n    }\n  } catch (error) {\n    showMessage('error', 'Oops! Something went wrong! Please try again.');\n  }\n}\n\nasync function searchMoreImages(text) {\n  elements.loadBtn.hidden = true;\n  page += 1;\n\n  try {\n    const response = await fetchImages(text);\n    const data = response.data.hits;\n    elements.gallery.insertAdjacentHTML('beforeend', createPhotoMarkup(data));\n    gallery.refresh();\n\n    if (page < maxPages) {\n      elements.loadBtn.hidden = false;\n    } else {\n      showMessage(\n        'info',\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    showMessage('error', 'Oops! Something went wrong! Please try again.');\n  }\n}\n\nfunction createPhotoMarkup(data) {\n  return data\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes</b>\n              <br />\n              ${likes}\n            </p>\n            <p class=\"info-item\">\n              <b>Views</b>\n              <br />\n              ${views}\n            </p>\n            <p class=\"info-item\">\n              <b>Comments</b>\n              <br />\n              ${comments}\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b>\n              <br />\n              ${downloads}\n            </p>\n          </div>\n        </a>\n      </div>`;\n      }\n    )\n    .join('');\n}\n\nfunction showMessage(type, message) {\n  let color;\n  if (type === 'error') {\n    color = '#f58e82';\n  } else {\n    color = '#9dfab5';\n  }\n\n  iziToast.show({\n    messageColor: '#262121',\n    backgroundColor: color,\n    messageSize: '18px',\n    position: 'bottomRight',\n    progressBar: false,\n    animateInside: false,\n    transitionIn: 'fadeIn',\n    transitionOut: 'fadeOut',\n    timeout: 3000,\n    targetFirst: false,\n    message: message,\n  });\n}\n\nfunction fetchImages(text) {\n  return axios.get('https://pixabay.com/api/', {\n    params: {\n      key,\n      q: text,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    },\n  });\n}\n"],"names":["key","elements","search","evt","form","searchImages","searchMoreImages","gallery","SimpleLightbox","page","maxPages","text","showMessage","response","fetchImages","data","createPhotoMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","type","message","color","iziToast","axios"],"mappings":"owBAOA,MAAMA,EAAM,qCAENC,EAAW,CACf,KAAM,SAAS,cAAc,iBAAiB,EAC9C,QAAS,SAAS,cAAc,aAAa,EAC7C,QAAS,SAAS,cAAc,YAAY,CAC9C,EAEA,IAAIC,EAEJD,EAAS,KAAK,iBAAiB,SAAUE,GAAO,CAC9CA,EAAI,eAAc,EAClB,MAAMC,EAAOD,EAAI,cACjBD,EAASE,EAAK,SAAS,YAAY,MACnCC,EAAaH,CAAM,EACnBE,EAAK,MAAK,CACZ,CAAC,EAEDH,EAAS,QAAQ,iBAAiB,QAAS,IAAM,CAC/CK,EAAiBJ,CAAM,CACzB,CAAC,EAED,MAAMK,EAAU,IAAIC,EAAe,4BAA4B,EAE/D,IAAIC,EACAC,EAEJ,eAAeL,EAAaM,EAAM,CAMhC,GALAV,EAAS,QAAQ,OAAS,GAC1BA,EAAS,QAAQ,UAAY,GAC7BQ,EAAO,EAEPE,EAAOA,EAAK,OACR,CAACA,EAAM,CACTC,EAAY,QAAS,6CAA6C,EAClE,MACD,CACD,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAYH,CAAI,EACvCD,EAAW,KAAK,KAAKG,EAAS,KAAK,UAAY,EAAE,EACjD,MAAME,EAAOF,EAAS,KAAK,KACtBE,EAAK,QAMRH,EACE,OACA,oBAAoBC,EAAS,KAAK,mBAC1C,EACMZ,EAAS,QAAQ,UAAYe,EAAkBD,CAAI,EACnDR,EAAQ,QAAO,EAEXE,EAAOC,EACTT,EAAS,QAAQ,OAAS,GAE1BW,EACE,OACA,4DACV,GAlBMA,EACE,QACA,0EACR,CAkBG,MAAC,CACAA,EAAY,QAAS,+CAA+C,CACrE,CACH,CAEA,eAAeN,EAAiBK,EAAM,CACpCV,EAAS,QAAQ,OAAS,GAC1BQ,GAAQ,EAER,GAAI,CAEF,MAAMM,GADW,MAAMD,EAAYH,CAAI,GACjB,KAAK,KAC3BV,EAAS,QAAQ,mBAAmB,YAAae,EAAkBD,CAAI,CAAC,EACxER,EAAQ,QAAO,EAEXE,EAAOC,EACTT,EAAS,QAAQ,OAAS,GAE1BW,EACE,OACA,4DACR,CAEG,MAAC,CACAA,EAAY,QAAS,+CAA+C,CACrE,CACH,CAEA,SAASI,EAAkBD,EAAM,CAC/B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,wCACyBL;AAAA,4CACID,WAAsBE;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKlDC;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKAC;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKAC;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKAC;AAAA;AAAA;AAAA;AAAA,aAMX,EACA,KAAK,EAAE,CACZ,CAEA,SAASX,EAAYY,EAAMC,EAAS,CAClC,IAAIC,EACAF,IAAS,QACXE,EAAQ,UAERA,EAAQ,UAGVC,EAAS,KAAK,CACZ,aAAc,UACd,gBAAiBD,EACjB,YAAa,OACb,SAAU,cACV,YAAa,GACb,cAAe,GACf,aAAc,SACd,cAAe,UACf,QAAS,IACT,YAAa,GACb,QAASD,CACb,CAAG,CACH,CAEA,SAASX,EAAYH,EAAM,CACzB,OAAOiB,EAAM,IAAI,2BAA4B,CAC3C,OAAQ,CACN,IAAA5B,EACA,EAAGW,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAF,EACA,SAAU,EACX,CACL,CAAG,CACH"}